CREATE DATABASE DBPCGDGV
GO

USE DBPCGDGV
GO

CREATE TABLE KHOA(
	IDKhoa VARCHAR(10) NOT NULL,
	TenKhoa NVARCHAR(30) NOT NULL,
	NgayThanhLap DATETIME NOT NULL,
	TruongKhoa VARCHAR(10) NOT NULL,
	PRIMARY KEY(IDKhoa)
)
GO

CREATE TABLE GIAOVIEN
(
	IDGV VARCHAR(10) NOT NULL,
	HoTen NVARCHAR(30) NOT NULL,
	GioiTinh NVARCHAR(3) NOT NULL,
	NgaySinh DATETIME NOT NULL,
	HocVi NVARCHAR(15) NOT NULL,
	NgayVaoLam DATETIME NOT NULL,
	SoTietDay INT NOT NULL,
	IDKhoa VARCHAR(10) NOT NULL,
	PRIMARY KEY(IDGV),
	FOREIGN KEY(IDKhoa) REFERENCES KHOA(IDKhoa)
)

CREATE TABLE MONHOC
(
	IDMH VARCHAR(10) NOT NULL,
	TenMH NVARCHAR(30) NOT NULL,
	TCLT INT NOT NULL,
	TCTH INT NOT NULL,
	IDKhoa VARCHAR(10) NOT NULL,
	PRIMARY KEY(IDMH),
	FOREIGN KEY(IDKhoa) REFERENCES KHOA(IDKhoa)
)
GO

CREATE TABLE GVM
(
	IDGV VARCHAR(10) NOT NULL,
	IDMH VARCHAR(10) NOT NULL,
	TongTC INT NOT NULL,
	PRIMARY KEY(IDMH, IDGV),
	FOREIGN KEY(IDGV) REFERENCES GIAOVIEN(IDGV),
	FOREIGN KEY(IDMH) REFERENCES MONHOC(IDMH)
)
GO


CREATE TABLE LOP
(
	IDLop VARCHAR(10) NOT NULL,
	TenLop NVARCHAR(30) NOT NULL,
	SiSo INT NOT NULL,
	HocKy INT NOT NULL,
	IDKhoa VARCHAR(10) NOT NULL,
	PRIMARY KEY(IDLop),
	FOREIGN KEY(IDKhoa) REFERENCES KHOA(IDKhoa)
)
GO

CREATE TABLE GVL
(
	IDGV VARCHAR(10) NOT NULL,
	IDLop VARCHAR(10) NOT NULL,
	TongTC INT NOT NULL,
	PRIMARY KEY(IDGV, IDLop),
	FOREIGN KEY(IDGV) REFERENCES GIAOVIEN(IDGV),
	FOREIGN KEY(IDLop) REFERENCES LOP(IDLop)
)
GO

CREATE TABLE NAMHOC
(
	IDNamHoc VARCHAR(10) NOT NULL,
	NamHoc INT NOT NULL,
	PRIMARY KEY(IDNamHoc),
)
GO

CREATE TABLE GVN
(
	IDGV VARCHAR(10) NOT NULL,
	IDNamHoc VARCHAR(10) NOT NULL,
	TongTC INT NOT NULL,
	PRIMARY KEY(IDGV, IDNamHoc),
	FOREIGN KEY(IDGV) REFERENCES GIAOVIEN(IDGV),
	FOREIGN KEY(IDNamHoc) REFERENCES NAMHOC(IDNamHoc)
)
GO

CREATE TABLE NHL
(
	IDNamHoc VARCHAR(10) NOT NULL,
	IDLop VARCHAR(10) NOT NULL,
	TongTC INT NOT NULL,
	PRIMARY KEY(IDNamHoc, IDLop),
	FOREIGN KEY(IDNamHoc) REFERENCES NamHoc(IDNamHoc),
	FOREIGN KEY(IDLop) REFERENCES LOP(IDLop)
)
GO

CREATE TABLE TAIKHOAN
(
	TenTaiKhoan VARCHAR(20) NOT NULL,
	MatKhau VARCHAR(100) NOT NULL,
	Email VARCHAR(50) NOT NULL,
	SDT VARCHAR(10) NOT NULL,
	TenNguoiDung NVARCHAR(50),
	PhanQuyen NVARCHAR(50),
	LoaiTaiKhoan NVARCHAR(50),
	PRIMARY KEY(TenTaiKhoan)
)
GO

set dateformat dmy;
GO

INSERT INTO TAIKHOAN(TenTaiKhoan, MatKhau, Email, SDT, TenNguoiDung, PhanQuyen, LoaiTaiKhoan) VALUES
('quanlygiangday', 'quanly123', 'quanlygiangdaynhom9@gmail.com', '0907865040', N'Quản Lý Giảng Dạy', N'Siêu Quản Trị', N'Cũ');
GO

SELECT TenNguoiDung AS 'Tên người dùng', Email, SDT AS 'SĐT',TenTaiKhoan AS 'Tên tài khoản', MatKhau As 'Mật khẩu', PhanQuyen AS 'Phân quyền', LoaiTaiKhoan AS 'Loại tài khoản'
FROM TAIKHOAN
GO